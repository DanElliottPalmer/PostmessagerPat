!function(){"use strict";function a(a,b,c){return a.addEventListener?a.addEventListener(b,c):a.attachEvent("on"+b,c)}function b(a,b){if("function"==typeof a.indexOf)return a.indexOf(b);for(var c=a.length;c--;)if(a[c]===b)return c;return-1}function c(a){return Object.prototype.toString.call(a).replace(/\[object ([\w]+)\]/i,"$1").toLowerCase()}function d(a,b,c){return a.removeEventListener?a.removeEventListener(b,c):a.detachEvent("on"+b,c)}function e(){this._destroying=!1,this._hook=function(a){var b=-1,c=0,d=null,e=a.origin;if(!this._destroying&&this.origins.hasOwnProperty(e)&&this.origins[e].length>0)for(b=-1,c=this.origins[e].length;!this._destroying&&++b<c;)d=this.origins[e][b],this._ids[d].handler(a);if(!this._destroying&&this.origins.hasOwnProperty("*")&&this.origins["*"].length>0)for(b=-1,c=this.origins["*"].length;!this._destroying&&++b<c;)d=this.origins["*"][b],this._ids[d].handler(a)}.bind(this),this._ids={},this.origins={},a(window,"message",this._hook)}Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),e.prototype={constructor:e,destroy:function(){var a=null;this._destroying=!0;for(a in this._ids)this._ids.hasOwnProperty(a)&&(this._ids[a]=null);this._ids=null;for(a in this.origins)this.origins.hasOwnProperty(a)&&(this.origins[a].length=0,this.origins[a]=null);this.origins=null,d(window,"message",this._hook),this._hook=null},publish:function(a,b,d){if("array"===c(b))for(var e=-1,f=b.length;++e<f;)a.postMessage(d,b[e]);else a.postMessage(d,b)},subscribe:function(a,b){var d=e.UID++;if(this._ids[d]={handler:b,origins:Array.prototype.concat(a)},"array"===c(a))for(var f=-1,g=a.length,h=null;++f<g;)h=a[f],this.origins.hasOwnProperty(h)||(this.origins[h]=[]),this.origins[h].push(d);else this.origins.hasOwnProperty(a)||(this.origins[a]=[]),this.origins[a].push(d);return d},unsubscribe:function(a){var c=-1,d=-1;if("string"==typeof a){if(!this.origins.hasOwnProperty(a))return;var e=null;for(d=-1,c=this.origins[a].length;c--;)e=this.origins[a][c],d=b(this._ids[e].origins,a),this._ids[e].origins.splice(d,1),0===this._ids[e].origins.length&&(this._ids[e]=null,delete this._ids[e]);return this.origins[a].length=0,void delete this.origins[a]}var f="";for(c=this._ids[a].origins.length;c--;)f=this._ids[a].origins[c],d=b(this.origins[f],a),this.origins[f].splice(d,1);this._ids[a].origins=null,this._ids[a].handler=null,delete this._ids[a]}},e.UID=0,window.PostmessagerPat=e}();